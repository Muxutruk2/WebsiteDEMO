{% extends 'base.html' %}
{% load static %}
{% block title %}Profile{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="profile-header">
        <div class="profile-picture">
            {% if profile.profile_picture %}
            <img src="{{ profile.profile_picture.url }}" alt="{{ user.username }}'s profile picture">
            {% else %}
            <img src="{% static 'default_profile_pic.jpg' %}" alt="Default profile picture">
            {% endif %}
        </div>
        <div class="profile-info">
            <h2>{{ user.username }}</h2>
            <p><strong>Bio:</strong> {{ profile.bio }}</p>
            <p><strong>Date of Birth:</strong> {{ profile.date_of_birth }}</p>
        </div>
    </div>
    
    <h3>Posts by {{ user.username }}</h3>
    <div class="post-list">
        {% for post in posts %}
        <div class="post-item">
            <a href="{% url 'post_detail' post.id %}">{{ post.title }}</a>
            <p>{{ post.content|truncatewords:30 }}</p>
        </div>
        {% endfor %}
    </div>

    <div class="account-actions">
        <h2>Change Password</h2>
        <form method="post">
            {% csrf_token %}
            {{ password_form.as_p }}
            <button type="submit">Change Password</button>
        </form>
    
        <hr>
    
        <h2>Delete Account</h2>
        <p>Deleting your account will permanently remove all data associated with it.</p>
        <form method="post" action="{% url 'delete_account' %}">
            {% csrf_token %}
            <button type="submit" onclick="return confirm('Are you sure you want to delete your account? This action cannot be undone.')">Delete Account</button>
        </form>
    </div>
</div>
{% endblock %}
